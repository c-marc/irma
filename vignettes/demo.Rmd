---
title: "Demo"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{demo}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library(tidyverse)
library(patchwork)
library(irma)
```


Make a dataset:

```{r}
n <- 80
p <- 0.2
se <- 0.8
sp <- 0.7

dat <- irma(n, p, se, sp)
dat
```

Check implied parameters (consequence of rounding):

```{r}
dat %>% get_param()
```

Plot it

```{r}
dat %>%
  mutate(
    test=factor(test, labels=c("T-","T+")),
    disease=factor(disease, labels=c("D-","D+"))
  ) %>%
  plot(fill_by=disease)
```

Or the other way:

```{r}
dat %>%
  mutate(
    test=factor(test, labels=c("T-","T+")),
    disease=factor(disease, labels=c("D-","D+"))
  ) %>%
  plot(fill_by=test)
```


Or patchwork:

```{r}
p1 <- dat %>%
  mutate(
    test=factor(test, labels=c("T-","T+")),
    disease=factor(disease, labels=c("D-","D+"))
  ) %>%
  plot(fill_by=disease, n_row=10, wrap = F)
p2 <- dat %>%
  mutate(
    test=factor(test, labels=c("T-","T+")),
    disease=factor(disease, labels=c("D-","D+"))
  ) %>%
  plot(fill_by=disease)
(p1 + p2)
```


TODO:
- [x] De-zeallotify
- [x] importFrom crazyness
- [x] Solve the S3 thing: no dispatching for autoplot plot
- [ ] Default fill_by ?
- [ ] Control missing arguments for plot
- [ ] Implement some rlang::abort for irma()
- [ ] Implement some rlang:: ... message() for irma() using get_param() and glue::glue

TODO shiny:
- [ ] Allow log10 variations for total
